"use strict";function getHumanUsersPresence(e,t){bot.api.users.getPresence({user:e},function(t,r){"active"==r.presence&&(p[e]=r.presence)})}function makeUserList(){bot.api.users.list({},function(e,t){for(var r=0;r<t.members.length;r++)userIDs[t.members[r].name]=t.members[r].id})}controller.hears("weather in (.*)","direct_mention",function(e,t){require("isomorphic-fetch"),process.env.FORECAST_KEY;var r=t.match[1],n=function(e){return"?units="+e};fetch("http://maps.googleapis.com/maps/api/geocode/json?address="+r).then(function(e){return e.json()}).then(function(e){console.log("Lat:",e.results[0].geometry.location.lat),console.log("Long:",e.results[0].geometry.location.lng);var t=e.results[0].geometry.location.lat.toString(),r=e.results[0].geometry.location.lng.toString(),n=t+","+r;return n}).then(function(o){fetch("https://api.forecast.io/forecast/"+process.env.FORECAST_KEY+"/"+o+n("si")).then(function(e){return e.json()}).then(function(n){console.log("weather summary:",n.currently.summary),console.log("current temperature:",n.currently.temperature),console.log("current humidity:",n.currently.humidity);var o="The current weather in "+r+" is "+n.currently.summary+" with a temperature of "+n.currently.temperature+"C";e.reply(t,o)})})["catch"](function(e){console.log("ERROR!")})}),controller.hears(["what can you do"],["mention","direct_message"],function(e,t){var r={text:"This is what I do so far...",attachments:[{title:"jQuery",text:"Jess-bot can't resist telling you what he thinks about jQuery"},{title:"what day is it?",text:"Clyde will tell you what the day is"},{title:"what is the date",text:"Clyde will tell you waht the date is"},{title:"Open the ---- doors",text:"Clyde may or may not help depending what type of door you ask him to open"},{title:"@clydebot: what is the answer to the ultimate question",text:"You can guess what comes next... \n Use toString() on a previously created varible to return a number (as a string) into the chat"},{title:"While you're typing -- REMOVED",text:"Randomly return a random message while user types"},{title:"user names",text:'tpye "user list" to list all users and bots in js1syd'},{title:"human users",text:'tpye "human users" to list all users in js1syd'},{title:"bot users",text:'tpye "bot users" to list all bots in js1syd'},{title:"user ---",text:'tpye "users" and their user/screen name for basic user information including their online status'},{title:"Random emoji",text:"Display a random emoji character"},{title:"weather in ---",text:"Dispaly the weather for any given (searchable) location"}]};return e.reply(t,r)});var randomNumber=function(e){return Math.floor(Math.random()*e)};controller.hears(["hello"],["mention"],function(e,t){e.reply(t,"That's me!")}),controller.hears(["pacman"],["ambient"],function(e,t){e.reply(t,"Run away!!")}),controller.hears(["post to clyde"],["direct_message"],function(e,t){var r={channel:"C1HC4RN1H",text:"blah",attachments:[{title:"post to bot-test-clyde",text:"some text in here.",color:"good",mrkdwn_in:["text","title","pretext","fields","value"]}]};e.api.chat.postMessage(r)}),controller.hears(["open the (.*) doors"],["ambient"],function(e,t){var r=t.match[1],n=["Do it yourself","Sure, why not","Open sesame..."];return"pod bay"===r?e.reply(t,"I'm sorry, Dave. I'm afraid I can't do that."):"blue"===r?e.reply(t,{attachments:[{text:"It's bigger on the inside??",image_url:"https://s-media-cache-ak0.pinimg.com/236x/99/b3/53/99b3539ad6802feee85e19bb13af08ae.jpg"}]}):e.reply(t,n[randomNumber(n.length)])}),controller.hears(["what is the date"],["ambient"],function(e,t){var r=new Date,n=r.getDate(),o=r.getMonth()+1,s=r.getFullYear(),a=(n+" / "+o+" / "+s).toString();e.reply(t,a)}),controller.hears(["what day is it"],["ambient"],function(e,t){var r=new Date,n=r.getDay(),o=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"];e.reply(t,o[n-1])}),controller.hears(["jquery"],["ambient"],function(e,t){e.reply(t,{text:"jQuery is awesome!",username:"jess-bot",icon_url:"https://pbs.twimg.com/profile_images/535601713659400193/bu3qboL9.png"})}),controller.hears(["ultimate question"],["direct_mention"],function(e,t){var r=42,n={text:"I'll take this one @clydebot. The answer to the ultimate question of Life, the Universe and Everything is... "+r.toString(),icon_url:"https://donhillson.files.wordpress.com/2012/04/deep_thought.png",username:"deep-thought"};return e.reply(t,n)}),controller.hears(["user list"],["ambient"],function(e,t){e.api.users.list({},function(r,n){r&&e.botkit.log("something went wrong",r);var o=[],s=n.members.length;e.botkit.log("number of users:",s);var a="number of users"+s.toString();e.reply(t,a);for(var i=0;i<=s;i++)if(i===s){var l=o.join("\n");e.reply(t,l)}else{var m=n.members[i].name;o.push(m),e.botkit.log("user name:",m)}})});var p={test:"blah"};controller.hears("get human users","direct_message",function(e,t){e.api.users.list({},function(t,r){t&&e.botkit.log("something went wrong",t);for(var n=[],o=0;o<r.members.length;o++)if(!r.members[o].is_bot&&"slackbot"!==r.members[o].name){var s=r.members[o].profile.first_name+" "+r.members[o].profile.last_name,a=r.members[o].id;getHumanUsersPresence(a,p),n.push(s)}})}),controller.hears("show online users","direct_message",function(e,t){var r=Object.keys(p);e.botkit.log(r)}),controller.hears("bot users","ambient",function(e,t){e.api.users.list({},function(r,n){r&&e.botkit.log("something went wrong",r),e.botkit.log("slackbot:   ",n.members[n.members.length-1]);for(var o=[],s=0;s<n.members.length;s++)if((n.members[s].is_bot||"slackbot"===n.members[s].name)&&n.members[s].deleted!==!0){var a=n.members[s].profile.first_name+" "+n.members[s].profile.last_name;e.botkit.log("user:   ",s,n.members[s].id),o.push(s+"\t"+a)}e.reply(t,o.join("\n"))})}),controller.hears("who is bot (.*)","ambient",function(e,t){var r=t.match[1];e.botkit.log(r),e.api.users.list({},function(n,o){n&&e.botkit.log("something went wrong",n);var s="deleted: "+o.members[r].name.toString();e.reply(t,s)})}),controller.hears("random emoji","ambient",function(e,t){e.api.emoji.list({},function(r,n){r&&e.botkit.log("something went wrong",r);var o=Object.keys(n.emoji),s=o.length;e.botkit.log("emoji:",n.emoji[o[randomNumber(s)-1]]);var a=o[randomNumber(s)-1],i=n.emoji[a],l={attachments:[{title:"Your random emoji is",text:a,image_url:i}]};e.reply(t,l)})});var userIDs={};makeUserList();var missingpersons=0;controller.hears("user (.*)",["ambient","direct_message"],function(e,t){var r=t.match[1],n="--",o={users:userIDs[r]},s={user:userIDs[r]};e.api.users.getPresence(s,function(e,t){n=t.presence}),void 0!==o.users?(missingpersons=0,e.api.users.list({},function(r,s){r&&e.botkit.log("something went wrong",r);for(var a=0;a<s.members.length;a++)if(s.members[a].id===o.users){var i={attachments:[{title:"They're real name is `"+s.members[a].real_name+"` \n`"+s.members[a].profile.title+"`",text:s.members[a].profile.first_name+" is currently "+n,image_url:s.members[a].profile.image_512}]};e.reply(t,i)}})):1===missingpersons?(e.reply(t,"Sorry, no one here by that name"),missingpersons=0):(e.reply(t,"Huh? I wasn't paying attention, can you repeat that?"),makeUserList(),missingpersons=1)}),bot.botkit.log("bot started"),controller.hears("pizzatime","direct_message",function(e,t){e.botkit.log("pizza started"),askFlavor=function(e,t){t.ask("What flavor of pizza do you want?",function(e,t){"pineapple"===e.text?(t.say("No way, that's nasty."),t.next()):(t.say("Nice."),askSize(e,t),t.next())})},askSize=function(e){function t(t,r){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(e,t){t.ask("Do you want a small, medium or large",function(e,t){"small"===e.text?(t.say(e.text+" it is"),askWhereDeliver(e,t),t.next()):"medium"===e.text?(t.say(e.text+" good call"),askWhereDeliver(e,t),t.next()):"large"===e.text?(t.say("bit of an appetite have we?"),askWhereDeliver(e,t),t.next()):(t.say("Can you repeat that?"),askSize(e,t),t.next())})}),askWhereDeliver=function(e,t){t.ask("So where do you want it delivered?",function(e,t){t.say("Done, pizza on it's way to "+e.text),t.next()})},e.startConversation(t,askFlavor)}),controller.hears(["keyword","^fish$, ^dragon$"],["direct_message"],function(e,t){e.reply(t,"You used a keyword!")});var keyPhrases=["Stark","Lanister","Greyjoy","Bolton"];controller.hears([keyPhrases],["direct_message"],function(e,t){e.reply(t,"You used a keyword!")}),bot.api.channels.list({},function(e,t){Object.keys(t)}),bot.api.channels.info({channel:"C0ZSX0Z9N"},function(e,t){}),bot.api.channels.history({channel:"C0ZSX0Z9N",count:1},function(e,t){}),bot.api.im.history({channel:"D1J7GEA6A",count:1},function(e,t){}),controller.hears("we need to talk","mention",function(e,t){e.api.im.open({user:"U16MQAW1L"},function(t,r){e.botkit.log("---- chat open"),e.api.chat.postMessage({channel:"U16MQAW1L",text:"Hello",as_user:"U1HDDKWCD"})})}),controller.hears("say my name","direct_message",function(e,t){var r=Object.keys(t);e.botkit.log("---- message keys:",r),r.forEach(function(r,n){e.botkit.log("---- key",n,r,t[r])}),e.botkit.log("---- user ",t.user),e.reply(t,"Your id is: "+t.user.name)}),controller.hears(["hello","hi"],"direct_message",function(e,t){e.api.reactions.add({timestamp:t.ts,channel:t.channel,name:"robot_face"},function(t,r){t&&e.botkit.log("Failed to add emoji reaction :(",t)}),controller.storage.users.get(t.user,function(r,n){n&&n.name?e.reply(t,"Hello "+n.name+"!!"):e.reply(t,"Hello. :squirrel:")})}),controller.hears(["call me (.*)","my name is (.*)"],"direct_message",function(e,t){var r=t.match[1];controller.storage.users.get(t.user,function(n,o){o||(o={id:t.user}),o.name=r,controller.storage.users.save(o,function(r,n){e.reply(t,"Got it. I will call you "+o.name+" from now on.")})})}),controller.hears("create channel called","direct_message",function(e,t){e.api.channels.create({name:"newTest"},function(t,r){e.botkit.log(t)}),e.botkit.log("done")});
//# sourceMappingURL=babel/source.js